% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}

\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
% Make \paragraph and \subparagraph free-standing
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi


\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\usepackage{unicode-math}
\usepackage{mathpazo}
\KOMAoption{captions}{tableheading}
\makeatletter
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[many]{tcolorbox}}
\makeatother
\makeatletter
\@ifundefined{shadecolor}{\definecolor{shadecolor}{rgb}{.97, .97, .97}}
\makeatother
\makeatletter
\makeatother
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={2023 honours multivariate FA practical},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}

\title{2023 honours multivariate FA practical}
\author{}
\date{}

\begin{document}
\maketitle
\ifdefined\Shaded\renewenvironment{Shaded}{\begin{tcolorbox}[sharp corners, breakable, interior hidden, enhanced, borderline west={3pt}{0pt}{shadecolor}, boxrule=0pt, frame hidden]}{\end{tcolorbox}}\fi

\hypertarget{question-one-4}{%
\subsection{Question One (4)}\label{question-one-4}}

Show that the covariance matrix

\[
\symbf{\rho} = 
\begin{bmatrix}
1 & 0.63 & 0.45 \\
0.63 & 1 & 0.35 \\
0.45 & 0.35 & 1 
\end{bmatrix}
\]

for the \(p=3\) standardised random variables \(Z_1\), \(Z_2\) and
\(Z_3\) can be generated by the \(m=1\) factor model

\begin{align*}
Z_1 &= 0.9F_1 + \epsilon_1 \\
Z_2 &= 0.7F_1 + \epsilon_2 \\
Z_3 &= 0.5F_1 + \epsilon_3
\end{align*}

where \(\mathrm{Var}[F_1]=1\),
\(\mathrm{Cov}[\symbf{\epsilon}, F_1]=\symbf{0}\) and

\[
\symbf{\Psi} = \mathrm{Cov}[\symbf{\epsilon}] = 
\begin{bmatrix}
0.19 & 0 & 0 \\
0 & 0.51 & 0 \\
0 & 0 & 0.75 
\end{bmatrix}.
\]

That is, write \(\symbf{\rho}\) in the form
\(\symbf{L}\symbf{L}' + \symbf{\Psi}\), where \(\symbf{L}\) is the
matrix of loadings and \(\symbf{\Psi}\) is the diagonal matrix of
specific variances.

\hypertarget{question-two-13}{%
\subsection{Question Two (13)}\label{question-two-13}}

Use the air pollution data stored in \texttt{Air\ Polution\ Data.csv}.

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  Generate a sample correlation matrix. (1)
\item
  Obtain the principal component solution to a factor model with \(m=1\)
  and \(m=2\) using the \texttt{eigen} function (as before, you must use
  the \texttt{eigen} function). (3)
\item
  Obtain the maximum likelihood factor model for \(m=2\) using
  \texttt{factanal}. (2)
\item
  Compare the factorization obtained by the principal component and
  maximum likelihood methods. (2)
\item
  Perform a varimax rotation of the principal component solution with
  \(m=2\) factors. Interpret the results. (3)
\item
  Calculate the factor scores from the m=2 maximum likelihood approach
  using weighted least squares (i.e.~using the matrix formula for the
  factor scores). (2)
\end{enumerate}

\hypertarget{question-three-4}{%
\subsection{Question Three (4)}\label{question-three-4}}

In FA we are concerned with accurately capturing the covariance of the
variables. In this question we prove an upper bound for the sum of
squared errors between our fitted covariance matrix and the sample
covariance matrix, when we use the principal component method.

For \(\symbf{S}:p\times p\) the sample covariance matrix,
\(\hat{\symbf{L}}:p\times m\) the matrix of loadings estimated using the
principal component method and \(\hat{\symbf{\Psi}}\) the diagonal
matrix of specific variances, show that

\[
\mathrm{tr}[(\symbf{S}-(\hat{\symbf{L}}\hat{\symbf{L}}' + \hat{\symbf{\Psi}}))'(\symbf{S}-(\hat{\symbf{L}}\hat{\symbf{L}}' + \hat{\symbf{\Psi}}))]\leq \sum_{i=m+1}^p\lambda_i^2.
\]

In other words, show that the sum of squared errors between the sample
covariance matrix and the fitted covariance matrix is upper bounded by
the sum of the squared eigenvalues of unused principal components.

\begin{itemize}
\tightlist
\item
  Note that
  \(\symbf{S}-(\hat{\symbf{L}}\hat{\symbf{L}}' + \hat{\symbf{\Psi}})\)
  has zeroes on the diagonal, meaning that
  \(\mathrm{tr}[(\symbf{S}-(\hat{\symbf{L}}\hat{\symbf{L}}' + \hat{\symbf{\Psi}}))'(\symbf{S}-(\hat{\symbf{L}}\hat{\symbf{L}}' + \hat{\symbf{\Psi}}))]\leq \mathrm{tr}[(\symbf{S}-\hat{\symbf{L}}\hat{\symbf{L}}')'(\symbf{S}-\hat{\symbf{L}}\hat{\symbf{L}}')]\)
\item
  Also note that
  \(\symbf{S}-\hat{\symbf{L}}\hat{\symbf{L}}'=\sum_{i=m+1}^p\lambda_i\symbf{e}_i\symbf{e}_i'\),
  where \(\symbf{e}_i\) is the eigenvector of \(\symbf{S}\) associated
  with the \(i\)-th largest eigenvalue \(\lambda_i\).
\item
  The trace property that
  \(\mathrm{tr}[\symbf{A}\symbf{B}\symbf{C}]=\mathrm{tr}[\symbf{C}\symbf{A}\symbf{B}]=\mathrm{tr}[\symbf{B}\symbf{C}\symbf{A}]\)
  and the transpose property that
  \(\symbf{A}\symbf{B})'=\symbf{B}'\symbf{A}'\) are useful here.
\end{itemize}



\end{document}
